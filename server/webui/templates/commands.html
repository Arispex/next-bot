<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NextBot Command Config</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5/dist/reset.css" />
  <script src="/webui/static/js/theme-init.js"></script>
  <style>
    :root {
      --bg-layout: #f5f7fa;
      --surface: #ffffff;
      --surface-soft: #fafafa;
      --text: #1f1f1f;
      --text-muted: #8c8c8c;
      --line: #f0f0f0;
      --line-strong: #d9d9d9;
      --primary: #1677ff;
      --primary-soft: #e6f4ff;
      --success: #52c41a;
      --danger: #ff4d4f;
      --danger-hover: #ff7875;
      --shadow: 0 1px 2px rgba(5, 5, 5, 0.06), 0 6px 16px rgba(5, 5, 5, 0.08);
    }

    html.dark {
      --bg-layout: #0f1115;
      --surface: #171a21;
      --surface-soft: #1c212c;
      --text: #f0f0f0;
      --text-muted: #a6a6a6;
      --line: #2f343f;
      --line-strong: #3c4452;
      --primary: #4096ff;
      --primary-soft: rgba(22, 119, 255, 0.18);
      --success: #95de64;
      --danger: #ff7875;
      --danger-hover: #ff9c9c;
      --shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      min-height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      color: var(--text);
      background: var(--bg-layout);
    }

    .app-layout {
      min-height: 100vh;
      display: flex;
      background: var(--bg-layout);
    }

    .app-sider {
      width: 208px;
      background: var(--surface);
      border-right: 1px solid var(--line);
      transition: width 0.2s ease, opacity 0.2s ease;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      opacity: 1;
      visibility: visible;
      box-shadow: inset -1px 0 0 var(--line);
    }

    .app-sider.is-collapsed {
      width: 0;
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      border-right-color: transparent;
      box-shadow: none;
    }

    .sider-head {
      height: 64px;
      padding: 0 18px;
      display: flex;
      align-items: center;
      gap: 12px;
      border-bottom: 1px solid var(--line);
      flex-shrink: 0;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--primary-soft);
      color: var(--primary);
      font-size: 14px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .brand-name {
      margin: 0;
      font-size: 15px;
      font-weight: 600;
      white-space: nowrap;
    }

    .app-sider.is-collapsed .brand-name {
      display: none;
    }

    .menu-wrap {
      padding: 12px 8px;
      flex: 1;
      overflow: auto;
    }

    .menu-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 4px;
    }

    .menu-link {
      height: 40px;
      border-radius: 8px;
      text-decoration: none;
      color: var(--text);
      padding: 0 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      line-height: 1;
      transition: all 0.2s ease;
    }

    .menu-link:hover {
      background: var(--surface-soft);
    }

    .menu-link.is-active {
      color: var(--primary);
      background: var(--primary-soft);
      font-weight: 500;
    }

    .menu-icon {
      width: 16px;
      text-align: center;
      flex-shrink: 0;
      font-size: 14px;
      opacity: 0.88;
    }

    .menu-label {
      white-space: nowrap;
    }

    .app-main {
      min-width: 0;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .app-header {
      height: 64px;
      background: var(--surface);
      border-bottom: 1px solid var(--line);
      padding: 0 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
    }

    .header-title {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .header-actions {
      margin-left: auto;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .header-actions form {
      margin: 0;
    }

    .btn {
      height: 34px;
      border-radius: 8px;
      border: 1px solid var(--line-strong);
      background: var(--surface);
      color: var(--text);
      padding: 0 12px;
      font-size: 13px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .btn-primary {
      background: var(--primary);
      border-color: var(--primary);
      color: #ffffff;
    }

    .btn-primary:hover {
      color: #ffffff;
      border-color: var(--primary);
      filter: brightness(1.04);
    }

    .btn-icon {
      width: 34px;
      padding: 0;
    }

    .btn-icon svg {
      width: 16px;
      height: 16px;
    }

    .theme-toggle-btn {
      width: 40px;
      height: 40px;
      padding: 0;
    }

    .theme-toggle-btn svg {
      width: 18px;
      height: 18px;
    }

    .icon-link {
      text-decoration: none;
    }

    .logout-icon-btn {
      color: var(--danger);
      border-color: color-mix(in srgb, var(--danger) 35%, var(--line-strong));
    }

    .logout-icon-btn:hover {
      color: #ffffff;
      background: var(--danger-hover);
      border-color: var(--danger-hover);
    }

    .logout-icon-btn svg {
      width: 18px;
      height: 18px;
    }

    .theme-icon-sun {
      display: none;
    }

    html.dark .theme-icon-sun {
      display: block;
    }

    html.dark .theme-icon-moon {
      display: none;
    }

    .app-content {
      padding: 20px;
      flex: 1;
      min-height: 0;
    }

    .command-hero {
      border: 1px solid var(--line);
      border-radius: 12px;
      background: var(--surface);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 16px;
    }

    .command-hero h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
    }

    .command-hero p {
      margin: 8px 0 0;
      font-size: 13px;
      color: var(--text-muted);
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
    }

    .tip {
      font-size: 13px;
      color: var(--text-muted);
    }

    .status {
      font-size: 13px;
      color: var(--text-muted);
      min-height: 20px;
      margin-bottom: 10px;
    }

    .status.error {
      color: var(--danger);
    }

    .status.success {
      color: var(--success);
    }

    .group {
      margin-bottom: 16px;
      border: 1px solid var(--line);
      border-radius: 12px;
      background: var(--surface);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .group-head {
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      background: var(--surface-soft);
      font-size: 13px;
      color: var(--text-muted);
      font-weight: 600;
    }

    .command-item {
      padding: 14px;
      border-bottom: 1px solid var(--line);
    }

    .command-item:last-child {
      border-bottom: none;
    }

    .command-head {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .command-name {
      font-size: 15px;
      font-weight: 600;
    }

    .command-key {
      font-size: 12px;
      color: var(--text-muted);
    }

    .command-perm {
      margin-top: 4px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .switch {
      margin-left: auto;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .params {
      margin-top: 12px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .param {
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 10px;
      background: var(--surface-soft);
    }

    .param-label {
      margin: 0 0 6px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text);
    }

    .param-desc {
      margin: 0 0 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .input,
    .select {
      width: 100%;
      height: 34px;
      border: 1px solid var(--line-strong);
      border-radius: 8px;
      background: var(--surface);
      color: var(--text);
      padding: 0 10px;
      font-size: 13px;
    }

    .input:focus,
    .select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 20%, transparent);
    }

    .empty {
      border: 1px dashed var(--line-strong);
      border-radius: 12px;
      padding: 24px;
      text-align: center;
      color: var(--text-muted);
      background: var(--surface);
    }

    .hidden {
      display: none !important;
    }

    @media (max-width: 900px) {
      .params {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 840px) {
      .app-header {
        padding: 0 14px;
      }

      .app-content {
        padding: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="app-layout">
    <aside id="webui-sidebar" class="app-sider">
      <div class="sider-head">
        <span class="brand-logo">NB</span>
        <p class="brand-name">NextBot Console</p>
      </div>

      <div class="menu-wrap">
        <ul class="menu-list">
          <li><a href="/webui" class="menu-link"><span class="menu-icon">◉</span><span class="menu-label">Dashboard</span></a></li>
          <li><a href="/webui/commands" class="menu-link is-active"><span class="menu-icon">⚙</span><span class="menu-label">Command Config</span></a></li>
          <li><a href="#" class="menu-link"><span class="menu-icon">▣</span><span class="menu-label">Server Management</span></a></li>
          <li><a href="#" class="menu-link"><span class="menu-icon">◎</span><span class="menu-label">User Management</span></a></li>
          <li><a href="#" class="menu-link"><span class="menu-icon">◌</span><span class="menu-label">Group &amp; Permission</span></a></li>
          <li><a href="#" class="menu-link"><span class="menu-icon">▤</span><span class="menu-label">Render Center</span></a></li>
        </ul>
      </div>
    </aside>

    <div class="app-main">
      <header class="app-header">
        <div class="header-left">
          <button id="sidebar-toggle" type="button" class="btn btn-icon" aria-label="隐藏侧边栏">☰</button>
          <h1 class="header-title">NextBot WebUI</h1>
        </div>

        <div class="header-actions">
          <a
            href="https://github.com/Arispex/next-bot"
            target="_blank"
            rel="noopener noreferrer"
            class="btn theme-toggle-btn icon-link"
            aria-label="打开 GitHub 仓库"
            title="GitHub"
          >
            <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
              <path d="M12 .5a11.5 11.5 0 0 0-3.64 22.41c.57.1.78-.24.78-.55v-2.1c-3.18.69-3.85-1.52-3.85-1.52-.52-1.3-1.27-1.64-1.27-1.64-1.05-.71.08-.69.08-.69 1.16.08 1.77 1.17 1.77 1.17 1.03 1.74 2.7 1.24 3.35.95.11-.74.4-1.24.73-1.53-2.54-.28-5.21-1.25-5.21-5.57 0-1.23.45-2.24 1.18-3.03-.12-.29-.51-1.44.11-3 0 0 .96-.3 3.15 1.16a11.1 11.1 0 0 1 5.74 0c2.19-1.46 3.14-1.16 3.14-1.16.63 1.56.24 2.71.12 3 .73.79 1.18 1.8 1.18 3.03 0 4.33-2.68 5.29-5.23 5.57.41.35.78 1.03.78 2.08v3.08c0 .31.2.66.79.55A11.5 11.5 0 0 0 12 .5Z"></path>
            </svg>
          </a>

          <button id="theme-toggle" type="button" class="btn theme-toggle-btn" aria-label="切换到深色主题">
            <svg class="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="4"></circle>
              <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"></path>
            </svg>
            <svg class="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3c0 .38.02.76.07 1.13A7 7 0 0 0 19.87 12c.37.05.75.07 1.13.07z"></path>
            </svg>
          </button>

          <form method="post" action="/webui/logout">
            <button type="submit" class="btn theme-toggle-btn logout-icon-btn" aria-label="退出登入" title="退出登入">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
              </svg>
            </button>
          </form>
        </div>
      </header>

      <main class="app-content">
        <section class="command-hero">
          <h2>Command Config</h2>
          <p>在这里统一管理命令开关与参数，点击保存后立即生效，无需重启服务。</p>
        </section>

        <div class="toolbar">
          <button id="reload-btn" type="button" class="btn">刷新</button>
          <button id="save-all-btn" type="button" class="btn btn-primary">保存全部</button>
          <span class="tip">保存会批量提交所有已修改命令，并即时刷新运行时配置。</span>
        </div>

        <div id="status" class="status"></div>
        <div id="loading" class="empty">加载中...</div>
        <div id="empty" class="empty hidden">暂无可配置命令。</div>
        <div id="groups"></div>
      </main>
    </div>
  </div>

  <script src="/webui/static/js/webui.js"></script>
  <script src="/webui/static/js/commands.js"></script>
</body>
</html>
